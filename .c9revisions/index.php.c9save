{"ts":1362696358645,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"<?php\nheader('Content-type: text/html; charset=utf-8');\nsession_start();\n\nrequire 'php/connect_inc.php';\n\n\nsession_name('draganddrool');\n// Starting the session\n\nif($_SESSION['id']){\n\theader(\"Location: project.php\");\n\texit;\n\t}\n\nsession_set_cookie_params(2*7*24*60*60);\n// Making the cookie live for 2 weeks\n\n\nif($_SESSION['id'] && !isset($_COOKIE['tzRemember']) && !$_SESSION['rememberMe'])\n{\n\t// If you are logged in, but you don't have the tzRemember cookie (browser restart)\n\t// and you have not checked the rememberMe checkbox:\n\n\t$_SESSION = array();\n\tsession_destroy();\n\n\t// Destroy the session\n}\n\nif($_POST['submit']=='Login')\n{\n\t// Checking whether the Login form has been submitted\n\n\t$err = array();\n\t// Will hold our errors\n\n\tif(!$_POST['username'] || !$_POST['password'])\n\t\t$err[] = 'All the fields must be filled in!';\n\n\tif(!count($err))\n\t{\n\t\t$_POST['username'] = mysqli_real_escape_string($link, $_POST['username']);\n\t\t$_POST['password'] = mysqli_real_escape_string($link, $_POST['password']);\n\t\t$_POST['rememberMe'] = (int)$_POST['rememberMe'];\n\n\t\t// Escaping all input data\n\n\t\t$row = mysqli_fetch_assoc(mysqli_query($link, \"SELECT id,name,lastusedgrid,ban FROM login WHERE name='{$_POST['username']}' AND pwd='\".md5($_POST['password']).\"'\"));\n\n\t\tif($row['name'])\n\t\t{\n\t\t\t// Check if the user is banned.\n\t\t\tif($row['ban']==1){echo('<h1>Your account was suspended.</h1><p>This could be due to illegal uploaded content. Please check out our FAQ.</p><h2>To get your account back, please send an individual request to <a href=\"mailto: info@draganddrool.tk\">info@draganddrool.tk</a>.\n\t\t\t<h3>We are sorry for the inconveniences, and wish you the best to get your account as-soon-as-possible back and running.</h3>');\n\t\t\texit;}\n\n\t\t\t\n\t\t\t// If everything is OK login\n\n\t\t\t$_SESSION['usr']=$row['name'];\n\t\t\t$_SESSION['id'] = $row['id'];\n\t\t\t$_SESSION['rememberMe'] = $_POST['rememberMe'];\n\t\t\t$_SESSION['gridid'] = $row['lastusedgrid'];\n\n\t\t\t\n\t\t\t// Store some data in the session\n\n\t\t\tsetcookie('tzRemember',$_POST['rememberMe']);\n\t\t\t// We create the tzRemember cookie\n\t\t\theader(\"Location: project.php\");\n\t\t\texit;\n\t\t}\n\t\telse $err[]='Wrong username and/or password!';\n\t\t\n\t\t\t\n\t\t}\n\t}\n\n\tif($err)\n\t\t$_SESSION['msg']['login-err'] = implode('<br />',$err);\n\t\t// Save the error messages in the session\n\n$script = '';\n\nif($_SESSION['msg'])\n{\n\t// The script below shows the sliding panel on page load\n\necho \"   \t<script type='text/javascript' src='jquery/jquery-1.9.0.min.js'></script>   \";\necho '<script type=\"text/javascript\">';\necho '$(function(){\n   $(\"#toggle\").prop(\"checked\",true);\n   $(\"#openmenu\").prop(\"checked\",true);\n});';\necho '</script>';\n\n\t\n}\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n<title>Drag&amp;Drool: Upload, Edit, Manage, Create</title>\n  \n  <link rel=\"stylesheet\" type=\"text/css\" href=\"grid.css\">\n\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"login_panel/css/slide.css\" media=\"screen\" />\n        \n        \n    <script type='text/javascript' src='jquery/jquery-1.9.0.min.js'></script>\n   \t<script type=\"text/javascript\" src=\"jquery/cssparentselector.js\"></script>\n  \t<script type='text/javascript' src=\"jquery/jquery.gridster.js\"></script> \n  \t<script type='text/javascript' src='jquery/jquery.jeditable.mini.js'></script>\n        \n    <!-- PNG FIX for IE6 -->\n    <!-- http://24ways.org/2007/supersleight-transparent-png-in-ie6 -->\n    <!--[if lte IE 6]>\n        <script type=\"text/javascript\" src=\"login_panel/js/pngfix/supersleight-min.js\"></script>\n    <![endif]-->\n\n\n<script type='text/javascript'>//<![CDATA[ \n$(window).load(function(){\n\n$(function(){ //DOM Ready\n    \n       $(\".gridster ul\").gridster({\n\t\t\tready: function() {$('#spinner').remove(); $('.gridster').css({opacity: 0.0, visibility: \"visible\"}).fadeTo(1050, 1.0);\n\t\t\t\t\t\t\t   $('#gridname').css({opacity: 0.0, visibility: \"visible\"}).delay(1800).fadeTo(1300, 1.0);\n\t\t\t\t\t\t\t  },\n            widget_margins: [5, 5],\n            widget_base_dimensions: [50, 50],\n\t\t\tserialize_params: function($w, wgd) {\n\t\t\t\treturn { id: $w.prop('id'), col: wgd.col, row: wgd.row, sizex: wgd.sizex, sizey: wgd.sizey };\n\t\t\t}\n        });\n\n    var gridster = $(\".gridster ul\").gridster().data('gridster');\n\n    /*\n    gridster.disable( );\n\n    $(\"li\").resizable({\n        grid: 50,\n        handles:\"all\",\n        minHeight:50,\n        minWidth:50,\n        // Xhelper: \"outline\",  Xanimate:true\n        stop: function(event,ui) {\n            gridster.enable();\n        },\n        start: function(event,ui) {\n            gridster.disable();\n        }\n    });\n    */\n});  \n         \n});//]]>\n</script>\n\n<script type=\"text/javascript\">\n\nfunction addBox(type, id)  {\n\tvar gridster = $(\".gridster ul\").gridster().data(\"gridster\");\n\tvar dynamicVal = \"<?php echo \"$actualgrid\"; ?>\";\n\n\tif ($('#nogridinfo')){\n\t\n\t$('#nogridinfo').remove();\n\n}\n\tswitch (type)\t{\ncase \"text\": content='<li id=\"' + id + '\"><p data-content-id=\"'+id+'\" onkeypress=\"return (this.textContent.length &lt;= 60)\" class=\"text editable\" contenteditable=\"true\">Click, to add your text content</p>';\n\t\t\tbreak;\n\ncase \"quote\": content='<li id=\"' + id + '\"><p data-content-id=\"'+id+'\" onkeypress=\"return (this.textContent.length &lt;= 60)\" class=\"quote editable\" contenteditable=\"true\">Click, to enter a quote</p>';\n\t\t\tbreak;\n\ncase \"image\": content='<li id=\"'+ id + '\"><img alt=\"image content\" data-content-id=\"'+id+'\" class=\"new image\" src=\"http://c.dart-examples.com/_/rsrc/1338345094325/config/customLogo.gif\">';\n\t\t\tbreak;\n\t\t\t}\n\tcontent = content + '<a class=\"remove_action\" data-id=\"'+id+'\">  <img alt=\"remove element\" class=\"actionicon\" src=icons/delete.png> </a></li>'\n\t  \tgridster.add_widget(content, 2, 2);\n\t}\n\n\n\n    $(document).ready(function() {\n    \t\n    \t\n    \t\n      \t// Reset Font Size\n\tvar originalFontSize = $(this).parents().siblings(\"p\").css('font-size');\n\t    $(document).on(\"click\", \".resetFont\", function(e){\n\t\t$(this).parents().siblings(\"p\").css('font-size', originalFontSize);\n\t\t$(this).parents().siblings(\"p\").css('font-weight', '400');\n\t\t\n\t});\n\t\n\t// Increase Font Size\n\t    $(document).on(\"click\", \".increaseFont\", function(e){\n\t\tvar currentFontSize = $(this).parents().siblings(\"p\").css('font-size');\n\t\tvar currentFontSizeNum = parseFloat(currentFontSize, 10);\n\t\tvar newFontSize = currentFontSizeNum*1.2;\n\t\t$(this).parents().siblings(\"p\").css('font-size', newFontSize);\n\t\treturn false;\n\t});\n\t\n\t// Decrease Font Size\n\t    $(document).on(\"click\", \".decreaseFont\", function(e){\n\t\tvar currentFontSize = $(this).parents().siblings(\"p\").css('font-size');\n\t\tvar currentFontSizeNum = parseFloat(currentFontSize, 10);\n\t\tvar newFontSize = currentFontSizeNum*0.8;\n\t\t$(this).parents().siblings(\"p\").css('font-size', newFontSize);\n\t\treturn false;\n\t});\n\t\n\t// Make bold\n\t$(document).on(\"click\", \".boldFont\", function(e){\n\t\tvar weight = $(this).parents().siblings(\"p\").css('font-weight');\n\t\tif (weight == 400)\n\t\t$(this).parents().siblings(\"p\").css('font-weight', 700)\n\t\t\n\t\telse \n\t\t$(this).parents().siblings(\"p\").css('font-weight', 400)\n\t\t\n\t\treturn false;\n\t});\n\t\n\n\t\t\t$(document).on(\"click\", \".remove_action\", function(e){\t\n\t\t\tvar id = $(this).data('id')\n\t\t\tvar grid = $('#gridname').data('actualgrid')\n\t\t\tvar gridster = $(\".gridster ul\").gridster({ widget_margins: [5, 5],\n            widget_base_dimensions: [50, 50], serialize_params: function($w, wgd) {\n\t\t\t\treturn { id: $w.prop('id'), col: wgd.col, row: wgd.row, sizex: wgd.sizex, sizey: wgd.sizey };\n\t\t\t}}).data('gridster');\n\n\t\t\tgridster.remove_widget( $('#' + id) );\n\n\t\t});\n\t\t\n\n\t\t$(\".new_action p\").click(function (e) {\t\n\t\t\tvar id = $('#gridname').data('actualgrid')\n\t\t\tvar type = $(this).data('type');\n\t \n\t\t});\n\n\n\t\t$(document).on(\"blur\", \".text, .quote\", function(e){\t\n\t\t\tvar id = $(this).data('content-id');\t\t\n\t\t\tvar content = $(this).text();\n\t\t\tvar type = $(this).attr('class').split(' ')[0];\n\t\t});\n\t\t\t\n\t});\n\n</script>\n\n</head>\n\n\n<body>\n\n<img id=\"spinner\" alt=\"Loading Boxes...\" src=\"/project/icons/image_381811.gif\" />\n\n<!-- Panel -->\n\n<div id=\"toppanel\">\n\t<div id=\"panel\">\n\t\t<div class=\"content clearfix\">\n\t\t\t<div class=\"left\">\n\t\t\t\t<a id=\"logo\" href=\"/project\">Drag&amp;<br>Drool</a>\n\t\t\t\t<h2>Your files in 2D boxes.</h2>\t\t\n\t\t\t\t<p class=\"grey\"><b>Upload, Edit, Manage, Create</b></p>\n\t\t\t</div>\n            \n            \n            <?php\n\t\t\t\n\t\t\tif(!$_SESSION['id']):\n\t\t\t\n\t\t\t?>\n            \n\t\t\t<div class=\"left\">\n\t\t\t\n\t\t\t                      \n        <i class=\"icon-home\" style=\"font-size:200%\"></i><h1>Member Login</h1>\n                \t\t<div id=\"recover\">\n                <label class=\"grey\" for=\"recovermail\">Your existing E-Mail adress:</label>\n                <input id=\"recovermail\" class=\"field\" type=\"password\" name=\"password\" size=\"23\">\n                </div>\n        <form id=\"login\" method=\"post\" action=\"index.php\">\n                <input tabindex=\"1\" class=\"field\" type=\"text\" name=\"username\" id=\"username\" value=\"\" size=\"23\">\n                <input tabindex=\"3\" alt=\"Login\" type=\"image\" src=\"icons/login/login_white.png\" name=\"submit\" value=\"Login\" class=\"bt_login\" >\n                <input type=\"hidden\" name=\"submit\" value=\"Login\">\n                <label style=\"display:none;\" id=\"remembermelabel\" for=\"rememberMe\">Remember</label>\n                <input tabindex=\"2\" class=\"field\" type=\"password\" name=\"password\" id=\"password\" size=\"23\">\n                \n\t\t\t\t<input title=\"Check to remember password\" name=\"rememberMe\" id=\"rememberMe\" type=\"checkbox\" value=\"1\" checked=\"checked\" style=\"\n    margin-top: 8px;\n    margin-left: -2px;\n\">\n                \n                <div class=\"clear\"></div>\n                <input id=\"recoverbox\" type=\"checkbox\" name=\"recoverbox\">\n                <label id=\"recoverlabel\" for=\"recoverbox\"></label>\n        </form>\n\n\t\t\t\t\t\t\n\t\t\t</div>\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t<div class=\"left right\" id=\"register\">\t\t\t\n\t\t\t\t<!-- Register Form -->\n\t\t\t\t<form action=\"php/add_user.php\" method=\"post\">\n\t\t\t\t\t<i class=\"icon-user-add\" style=\"font-size:200%\"></i><h1>Not a member yet?</h1>\t\t\n                     <?php\n\t\t\t\t\t\t\n\t\t\t\t\t\tif($_SESSION['msg']['reg-err'])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\techo '<div class=\"err\">'.$_SESSION['msg']['reg-err'].'</div>';\n\t\t\t\t\t\t\tunset($_SESSION['msg']['reg-err']);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif($_SESSION['msg']['reg-success'])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\techo '<div class=\"success\">'.$_SESSION['msg']['reg-success'].'</div>';\n\t\t\t\t\t\t\tunset($_SESSION['msg']['reg-success']);\n\t\t\t\t\t\t}\n\t\t\t\t\t?>\n                                        \t\t\n\t\t\t\t\t<label class=\"grey\" for=\"new_email\">E-Mail:</label>\n\t\t\t\t\t<input class=\"field\" type=\"email\" name=\"new_email\" id=\"new_email\" value=\"\" maxlength=\"28\" size=\"23\">\n\t\t\t\t\t<label class=\"grey\" for=\"new_username\" style=\"\n    width: 111px;\n\">Username:</label>\n\t\t\t\t\t<label class=\"grey\" for=\"new_password\" style=\"\n    width: 111px;\n\">Password:</label><input class=\"field\" type=\"text\" name=\"new_username\" id=\"new_username\" size=\"23\" maxlength=\"14\" style=\"\n    width: 89px;\n\">\n\t\t\t\t\t\n\t\t\t\t\t<input class=\"field\" type=\"password\" name=\"new_password\" id=\"new_password\" size=\"23\" maxlength=\"20\" style=\"\n    width: 89px;\n\"><input style=\"margin-top:2px\" type=\"submit\" name=\"submit\" value=\"Sign up for free\" class=\"bt_register\">\n\t\t\t\t</form>\n\t\t\t\t\n\t\t\t</div>\n            \n            \n            \n            <?php\n\t\t\tendif;\n\t\t\t?>\n\t\t</div>\n\t</div> <!-- /login -->\t\n\n    <!-- The tab on top -->\t\n\t<div class=\"tab\">\n\t\t<ul class=\"login\">\n\t    \t<li class=\"left\">&nbsp;</li>\n\t        <li>Welcome!</li>\n\t\t\t<li id=\"li_last\">\n\t\t\t<input name=\"toggle\" type=\"checkbox\" id=\"toggle\">\n\t\t\t<label id=\"menulabel\" for=\"toggle\">Menu</label>\n\t\t\t</li>\n\t    \t<li class=\"right\">&nbsp;</li>\n\t\t</ul> \n\t</div> <!-- / top -->\n\t\n</div> <!--panel -->\n\n<?php\n  require 'php/connect_inc.php';\n\nfunction db_result($result)\n{\nif ($result->num_rows == 0)\n    return;\n$result->data_seek(0);\n$row=$result->fetch_row();     \nreturn $row[0];\n}\n\n\t$actualgrid = 2;\n\n\t$sql_gridentries = mysqli_query($link,'SELECT * FROM gridentries WHERE gridtable='.$actualgrid);\n\t$sql_grid = mysqli_query($link,'SELECT * FROM grid WHERE grid.id='.$actualgrid);\n\n\t\n\t$t = mysqli_fetch_array($sql_grid);\n\n// Show the latest change to the actual grid\n    \t\n  \tif ( !$sql_gridentries || !$sql_grid) \n       \t\tdie(mysqli_error());\n\n \techo '<div id=\"status\"></div>\n \t\n\t<div class=\"gridster\">\n\t\n    \t<ul id=\"resizable\">';\n\t \n\twhile($t = mysqli_fetch_array($sql_gridentries))\n\t{\t\t \n\t\t\t if ($t['type'] == 'image')\n\t\t\t {\n\t\t\t\t$type='<img data-content-id=\"'.$t['id'].'\" alt=\"image content\" class=\"image\" src=\"' . $t['content'] . '\"/>';\n\t\t\t }\n\t\t\t \n\t\t\t if ($t['type'] == 'text')\n\t\t\t {\n\t\t\t\t$type='<p data-content-id=\"'.$t['id'].'\" onkeypress=\"return (this.textContent.length <= 60)\" class=\"text editable\" contentEditable=\"true\">' . $t['content'] . '</p><div class=\"button_group\">\t<a href=\"#\" class=\"gradient button increaseFont\">+</a><a href=\"#\" class=\"gradient button decreaseFont\">-</a><a href=\"#\" class=\"gradient button boldFont\">B</a></div>';\n\t\t\t }\n\t\t\t\n\t\t\t if ($t['type'] == 'quote')\n\t\t\t {\n\t\t\t\t$type='<p data-content-id=\"'.$t['id'].'\" onkeypress=\"return (this.textContent.length <= 60)\" class=\"quote editable\" contentEditable=\"true\" >' . $t['content'] . '</p><div class=\"button_group\">\t<a href=\"#\" class=\"gradient button increaseFont\">+</a><a href=\"#\" class=\"gradient button decreaseFont\">-</a><a href=\"#\" class=\"gradient button boldFont\">B</a></div><br />';\n\t\t\t }\n\t\t\techo ('<li id=\"' . $t['id'] . '\" data-row=\"' . $t['datarow'].'\" data-col=\"' . $t['datacolumn'] . '\" data-sizex=\"2\" data-sizey=\"2\">' . $type);\t\t\t\n\t\t\t\n\t\t\techo '<a class=\"remove_action\" data-id=\"'.$t['id'].'\">  <img alt=\"remove element\" class=\"actionicon\" src=icons/delete.png> </a>\n\t\t\t</li>';\n\t} \n\n\n?>\n\n    </ul>\n</div>\n\n</body>\n\n\n\n</html>\n"]],"start1":0,"start2":0,"length1":0,"length2":13546}]],"length":13546}
{"contributors":[],"silentsave":true,"ts":1362696371658,"patch":[[{"diffs":[[0,"\" href=\""],[1,"login/"],[0,"grid.css"]],"start1":2781,"start2":2781,"length1":16,"length2":22}]],"length":13552,"saved":false}
{"ts":1362696378013,"patch":[[{"diffs":[[0,"\" href=\""],[-1,"login"],[1,"css"],[0,"/grid.cs"]],"start1":2781,"start2":2781,"length1":21,"length2":19},{"diffs":[[0,"\" href=\""],[-1,"login_panel/"],[0,"css/slid"]],"start1":2846,"start2":2846,"length1":28,"length2":16}]],"length":13538,"saved":false}
{"ts":1362696470966,"patch":[[{"diffs":[[0,"rc=\""],[-1,"/project/"],[0,"icon"]],"start1":7846,"start2":7846,"length1":17,"length2":8}]],"length":13529,"saved":false}
{"contributors":[],"silentsave":true,"ts":1362727143863,"patch":[[{"diffs":[[0,"pt>\n"],[-1,"   \t<script type=\"text/javascript\" src=\"jquery/cssparentselector.js\"></script>\n"],[0,"  \t<"]],"start1":2979,"start2":2979,"length1":87,"length2":8}]],"length":13450,"saved":false}
